graph TB
    subgraph "HashiCorp Vault Architecture"
        subgraph "Applications"
            App1[Spring Boot App]
            App2[Kubernetes Pod]
            App3[Legacy App]
        end

        subgraph "Vault Cluster"
            V1[Vault Node 1<br/>Active]
            V2[Vault Node 2<br/>Standby]
            V3[Vault Node 3<br/>Standby]
        end

        subgraph "Secrets Engines"
            KV[KV Store<br/>Static Secrets]
            DB_SE[Database Engine<br/>Dynamic Creds]
            PKI[PKI Engine<br/>Certificates]
        end

        subgraph "External Systems"
            DB[(PostgreSQL)]
            K8s[Kubernetes<br/>Auth]
            LDAP[LDAP/AD<br/>Auth]
        end

        subgraph "Storage"
            Raft[(Raft Storage<br/>HA Backend)]
        end
    end

    App1 -->|AppRole Auth| V1
    App2 -->|K8s Auth| V1
    App3 -->|Agent Proxy| V1
    V1 --> KV
    V1 --> DB_SE
    V1 --> PKI
    DB_SE -->|Generate Creds| DB
    V1 -.Replication.-> V2
    V1 -.Replication.-> V3
    V1 --> Raft
    V2 --> Raft
    V3 --> Raft
    V1 -.Auth.-> K8s
    V1 -.Auth.-> LDAP

    style App1 fill:#60a5fa
    style App2 fill:#60a5fa
    style App3 fill:#60a5fa
    style V1 fill:#fbbf24
    style V2 fill:#d1d5db
    style V3 fill:#d1d5db
    style KV fill:#34d399
    style DB_SE fill:#8b5cf6
    style PKI fill:#ec4899
    style DB fill:#6366f1
    style Raft fill:#ef4444
    style K8s fill:#f59e0b
    style LDAP fill:#f59e0b
